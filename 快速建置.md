# 快速安裝及啟動(發布版前端自動build)
## 1. 下載程式
```sh
git clone https://github.com/violetzu/PrivNurseAI.git
cd PrivNurseAI/
```
## 2. 將兩個.gguf模型放到 models/
確認模型名稱是否一致
models/create_model.sh [53-56行](models/create_model.sh#53)  可自行增加
## 3. 使用建議.env 或自行修改
```sh
cp privnurse_gemma3n/backend/.env.example privnurse_gemma3n/backend/.env
cp privnurse_gemma3n/frontend/.env.local.example privnurse_gemma3n/frontend/.env
```
## 4. 執行程式
```sh
docker compose up -d --build
```
### 前端要使用開發模式的話把 compose [72、73行](docker-compose.yml#73)互相反註解

# Excel檔案匯入資料庫
```sh
cd Data_Preprocessing/
```
確保目錄如下
```sh
Data_Preprocessing
└── 病歷摘要資料
    ├── 出院摘要
    │   ├── 急診出院摘要_part1.xlsx
    │   ├── .....
    │   └──急診出院摘要_part4.xlsx
    ├── 會診紀錄
    │   └── .....
    ├── 檢驗報告
    │   └── .....
    └── 護理紀錄
        └── .....
```
```sh
bash excel2db.sh
```

# Ubuntu 安裝 Docker + NVIDIA Container Toolkit
## 0. 前置條件
在開始前請先確認：
- 系統已安裝 Ubuntu
- 主機已正確安裝 NVIDIA 顯示卡驅動
- 能執行：`nvidia-smi` 如果可以看到 GPU 資訊，代表驅動 OK。
## 1. 更新系統套件
```sh
sudo apt update
sudo apt upgrade -y
```
## 2. 安裝 Docker
### (1) 安裝必要工具
```sh
sudo apt install -y ca-certificates curl gnupg lsb-release
```
### (2) 加入 Docker 官方 GPG key
```sh
sudo mkdir -p /etc/apt/keyrings
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | \
sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
```
### (3) 加入 Docker repository
```sh
echo \
"deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] \
https://download.docker.com/linux/ubuntu \
$(lsb_release -cs) stable" | \
sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
```
### (4) 安裝 Docker Engine
```sh
sudo apt update
sudo apt install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
```
## 3. 驗證 Docker 是否正常
```sh
sudo docker run hello-world
```
若看到 Hello from Docker! 代表成功
## 4. 讓目前使用者可免 sudo 使用 docker（建議）
```sh
sudo usermod -aG docker $USER
newgrp docker
```
重新開一個 terminal 後測試：
```sh
docker run hello-world
```
## 5. 安裝 NVIDIA Container Toolkit
### (1) 加入 NVIDIA repository
```sh
curl -fsSL https://nvidia.github.io/libnvidia-container/gpgkey | \
sudo gpg --dearmor -o /usr/share/keyrings/nvidia-container-toolkit-keyring.gpg
```
```sh
curl -s -L https://nvidia.github.io/libnvidia-container/stable/deb/nvidia-container-toolkit.list | \
sed 's#deb https://#deb [signed-by=/usr/share/keyrings/nvidia-container-toolkit-keyring.gpg] https://#g' | \
sudo tee /etc/apt/sources.list.d/nvidia-container-toolkit.list
```
### (2) 安裝 toolkit
```sh
sudo apt update
sudo apt install -y nvidia-container-toolkit
```
## 6. 設定 Docker 使用 NVIDIA runtime
```sh
sudo nvidia-ctk runtime configure --runtime=docker
sudo systemctl restart docker
```
## 7. 測試 GPU 是否能在 Docker 使用
```sh
docker run --rm --gpus all nvidia/cuda:12.2.0-base-ubuntu22.04 nvidia-smi
```
如果你在容器內看到 GPU 列表 → 成功 ✅